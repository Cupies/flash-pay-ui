import{_ as N,d as L,r as l,k as r,o as k,b as C,w as s,l as t,c as A,F as U,C as B,a as V,p as $,E as y,h as D,i as z,t as h,G as R,H as W}from"./index-c4ccb8e7.js";import{a as q,d as F}from"./pay-3a9900c7.js";import{a as P,c as E,g as O,u as G,d as M}from"./organization-8a6699c2.js";import{P as T}from"./index-06e87c0b.js";const j=L({name:"CreateTasks",props:{dialogVisible:{type:Boolean,default:!1}},emits:["update:dialogVisible"],setup(e,{emit:o}){const m=l(e.dialogVisible),c=l({storeAddress:"",storeName:"",storeNumber:0,parentId:0,storeStatus:"",merchantId:0}),f=l({storeName:"",storeNumber:""}),g=l([]),a=l([]);watch(()=>e.dialogVisible,u=>{m.value=u});const n=()=>{d()},d=async()=>{try{const u=await P(1,10,f.value);g.value=u.items}catch(u){console.error(u),y.error("获取成员数据失败")}};return{syncDialogVisible:m,form:c,storeFrom:f,memberList:g,list:a,opend:n,getList:d,ensureDialog:async()=>{if(c.value.storeAddress===""||c.value.storeName===""||a.value.length===0){y.error("必填项不能为空");return}try{await E(c.value,a.value),o("update:dialogVisible",!1),y.success("创建成功")}catch(u){console.error(u),y.error("创建失败")}}}}}),H={slot:"footer",class:"dialog-footer"};function J(e,o,m,c,f,g){const a=r("el-input"),n=r("el-form-item"),d=r("el-option"),b=r("el-select"),u=r("el-form"),i=r("el-button"),p=r("el-dialog");return k(),C(p,{title:"新增门店",visible:e.syncDialogVisible,onOpen:e.opend},{default:s(()=>[t(u,{inline:!1},{default:s(()=>[t(n,{label:"门店名称: ","label-width":e.formLabelWidth,rules:[{required:!0}]},{default:s(()=>[t(a,{modelValue:e.form.storeName,"onUpdate:modelValue":o[0]||(o[0]=v=>e.form.storeName=v)},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"门店地址: ","label-width":e.formLabelWidth,rules:[{required:!0}]},{default:s(()=>[t(a,{modelValue:e.form.storeAddress,"onUpdate:modelValue":o[1]||(o[1]=v=>e.form.storeAddress=v)},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"门店编号: ","label-width":e.formLabelWidth,rules:[{required:!0}]},{default:s(()=>[t(a,{modelValue:e.form.storeNumber,"onUpdate:modelValue":o[2]||(o[2]=v=>e.form.storeNumber=v)},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"管理员: ",rules:[{required:!0}]},{default:s(()=>[t(b,{modelValue:e.list,"onUpdate:modelValue":o[3]||(o[3]=v=>e.list=v),multiple:"",placeholder:"请选择"},{default:s(()=>[(k(!0),A(U,null,B(e.memberList,v=>(k(),C(d,{key:v.id,label:v.username,value:v.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),V("div",H,[t(i,{onClick:o[4]||(o[4]=v=>e.syncDialogVisible=!1)},{default:s(()=>[...o[5]||(o[5]=[$("取 消",-1)])]),_:1}),t(i,{type:"primary",onClick:e.ensureDialog},{default:s(()=>[...o[6]||(o[6]=[$("确 定",-1)])]),_:1},8,["onClick"])])]),_:1},8,["visible","onOpen"])}const K=N(j,[["render",J]]),Q=L({name:"PaymentDialog",props:{dialogVisible:{type:Boolean,default:!1},code:{type:String,default:""}},emits:["update:dialogVisible","update:code"],setup(e,{emit:o}){const m=l(e.dialogVisible),c=l(e.code),f=l(1),g=l(10),a=l(0),n=l(0),d=l({appId:"",authCode:"",subject:"",totalAmount:0}),b=l([]),u=l([]);D(()=>e.dialogVisible,w=>{m.value=w}),D(()=>e.code,w=>{c.value=w}),z(()=>{p()});const i=async()=>{},p=async()=>{};return{syncDialogVisible:m,codes:c,pageNo:f,pageSize:g,appId:a,storeId:n,form:d,list:b,storeList:u,opend:i,getList:p,ensureDialog:()=>{m.value=!1}}}}),X=["src"],Y={slot:"footer",class:"dialog-footer"};function Z(e,o,m,c,f,g){const a=r("el-button"),n=r("el-dialog");return k(),C(n,{title:"",visible:e.syncDialogVisible,onOpen:e.opend,width:"250px"},{default:s(()=>[V("img",{src:e.codes,alt:""},null,8,X),V("div",Y,[t(a,{type:"primary",onClick:e.ensureDialog},{default:s(()=>[...o[0]||(o[0]=[$("确定",-1)])]),_:1},8,["onClick"])])]),_:1},8,["visible","onOpen"])}const x=N(Q,[["render",Z]]),ee=L({name:"CreateTasks",props:{dialogVisible:{type:Boolean,default:!1},storeIds:{type:String,default:""}},emits:["update:dialogVisible","update:storeIds"],setup(e,{emit:o}){const m=l(e.dialogVisible),c=l(e.storeIds),f=l({storeAddress:"",storeName:"",storeNumber:0,parentId:0,storeStatus:"",merchantId:0}),g=l({storeNumber:"",storeName:""}),a=l([]),n=l([]);D(()=>e.dialogVisible,i=>{m.value=i}),D(()=>e.storeIds,i=>{c.value=i});const d=()=>{b()},b=async()=>{try{const i=await O(1,10,g.value);a.value=i.items,n.value=a.value.filter(p=>c.value==p.id),f.value.storeName=n.value[0].storeName,f.value.storeAddress=n.value[0].storeAddress,f.value.storeNumber=n.value[0].storeNumber}catch(i){console.error(i),y.error("获取数据失败")}};return{syncDialogVisible:m,storeId:c,form:f,storeForm:g,listData:a,filterData:n,opend:d,getList:b,ensureDialog:async()=>{try{await G(f.value),o("update:dialogVisible",!1),y.success("修改成功")}catch(i){console.error(i),y.error("修改失败")}}}}}),oe={slot:"footer",class:"dialog-footer"};function te(e,o,m,c,f,g){const a=r("el-input"),n=r("el-form-item"),d=r("el-form"),b=r("el-button"),u=r("el-dialog");return k(),C(u,{title:"修改门店信息",visible:e.syncDialogVisible,onOpen:e.opend},{default:s(()=>[t(d,{inline:!1},{default:s(()=>[t(n,{label:"门店名称: ","label-width":e.formLabelWidth,rules:[{required:!0}]},{default:s(()=>[t(a,{modelValue:e.form.storeName,"onUpdate:modelValue":o[0]||(o[0]=i=>e.form.storeName=i)},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"门店地址: ","label-width":e.formLabelWidth},{default:s(()=>[t(a,{modelValue:e.form.storeAddress,"onUpdate:modelValue":o[1]||(o[1]=i=>e.form.storeAddress=i)},null,8,["modelValue"])]),_:1},8,["label-width"]),t(n,{label:"门店编号: ","label-width":e.formLabelWidth},{default:s(()=>[t(a,{modelValue:e.form.storeNumber,"onUpdate:modelValue":o[2]||(o[2]=i=>e.form.storeNumber=i)},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1}),V("div",oe,[t(b,{onClick:o[3]||(o[3]=i=>e.syncDialogVisible=!1)},{default:s(()=>[...o[4]||(o[4]=[$("取 消",-1)])]),_:1}),t(b,{type:"primary",onClick:e.ensureDialog},{default:s(()=>[...o[5]||(o[5]=[$("确 定",-1)])]),_:1},8,["onClick"])])]),_:1},8,["visible","onOpen"])}const le=N(ee,[["render",te]]),se=L({name:"AppDialog",props:{dialogVisible:{type:Boolean,default:!1}},emits:["update:dialogVisible","getAppId"],setup(e,{emit:o}){const m=l(e.dialogVisible),c=l(1),f=l(10),g=l(""),a=l(""),n=l([]),d=l([]);D(()=>e.dialogVisible,p=>{m.value=p});const b=()=>{u()},u=async()=>{try{n.value=await q()}catch(p){console.error(p),y.error("获取应用列表失败")}};return{syncDialogVisible:m,pageNo:c,pageSize:f,appId:g,storeId:a,list:n,storeList:d,opend:b,getList:u,ensureDialog:()=>{m.value=!1,console.log(g.value),o("getAppId",g.value)}}}}),ae={slot:"footer",class:"dialog-footer"};function ne(e,o,m,c,f,g){const a=r("el-option"),n=r("el-select"),d=r("el-form-item"),b=r("el-form"),u=r("el-button"),i=r("el-dialog");return k(),C(i,{title:"选择应用",visible:e.syncDialogVisible,onOpen:e.opend},{default:s(()=>[t(b,{inline:!1},{default:s(()=>[t(d,{label:"默认应用: "},{default:s(()=>[t(n,{modelValue:e.appId,"onUpdate:modelValue":o[0]||(o[0]=p=>e.appId=p),placeholder:"请选择"},{default:s(()=>[(k(!0),A(U,null,B(e.list,p=>(k(),C(a,{key:p.appId,label:p.appName,value:p.appId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),V("div",ae,[t(u,{onClick:o[1]||(o[1]=p=>e.syncDialogVisible=!1)},{default:s(()=>[...o[2]||(o[2]=[$("取 消",-1)])]),_:1}),t(u,{type:"primary",onClick:e.ensureDialog},{default:s(()=>[...o[3]||(o[3]=[$("确 定",-1)])]),_:1},8,["onClick"])])]),_:1},8,["visible","onOpen"])}const ie=N(se,[["render",ne]]);const re=L({name:"StoreList",components:{AddStore:K,Pagination:T,SetCode:x,UpdateStore:le,SetUse:ie},setup(){const e=l([]),o=l(1),m=l(10),c=l(0),f=l(!1),g=l(!1),a=l(!1),n=l(!1),d=l(""),b=l(""),u=l(""),i=l({storeName:"",storeNumber:""}),p=l({totalAmount:"",body:""});z(()=>{v()});const v=async()=>{try{const _=await O(o.value,m.value,i.value);e.value=_.items,c.value=e.value.length}catch(_){console.error(_),y.error("获取门店数据失败")}};return{list:e,pageNo:o,pageSize:m,total:c,dialogVisible:f,dialogVisible1:g,dialogVisible2:a,dialogVisible3:n,appId:d,codes:b,storeId:u,storeForm:i,form:p,getList:v,checkUse:()=>{n.value=!0},openSkuDialog:()=>{f.value=!0},getAppIds:_=>{d.value=_},updateClick:_=>{console.log(_),u.value=_.id,a.value=!0},setCode:async _=>{if(d.value===""){y.error("请先选择应用");return}try{b.value=await F(d.value,_.id,p.value.body,p.value.totalAmount),g.value=!0}catch(I){console.error(I),y.error("生成支付码失败")}},deleteClick:async _=>{try{await M(_.id)?(y({message:"删除成功",type:"success",duration:2*1e3}),v()):y({message:"删除失败",type:"error",duration:2*1e3})}catch(I){console.error(I),y.error("删除门店失败")}}}}}),de={class:"data-container"},ue={"slot-scope":"scope"},pe={"slot-scope":"scope"},me={"slot-scope":"scope"},ce={"slot-scope":"scope"},fe={"slot-scope":"scope"};function ge(e,o,m,c,f,g){const a=r("el-button"),n=r("el-row"),d=r("el-table-column"),b=r("el-table"),u=r("addStore"),i=r("setCode"),p=r("updateStore"),v=r("setUse"),w=r("pagination");return k(),A("div",de,[o[8]||(o[8]=V("h3",null,"门店管理",-1)),t(n,{type:"flex",justify:"end",class:"add"},{default:s(()=>[t(a,{type:"primary",size:"medium",onClick:e.checkUse,id:"addBtn"},{default:s(()=>[...o[3]||(o[3]=[$("选择应用",-1)])]),_:1},8,["onClick"]),t(a,{type:"primary",size:"medium",onClick:e.openSkuDialog,id:"addBtn"},{default:s(()=>[...o[4]||(o[4]=[$("新增",-1)])]),_:1},8,["onClick"])]),_:1}),t(b,{data:e.list,fit:"","highlight-current-row":"","header-cell-style":{color:"#5373e0",background:"#f3f6fb"},style:{width:"100%"}},{default:s(()=>[t(d,{align:"center",label:"门店编号"},{default:s(()=>[V("template",ue,[V("span",null,h(e.scope.row.storeNumber),1)])]),_:1}),t(d,{align:"center",label:"门店名称"},{default:s(()=>[V("template",pe,[V("span",null,h(e.scope.row.storeName),1)])]),_:1}),t(d,{align:"center",label:"地址"},{default:s(()=>[V("template",me,[V("span",null,h(e.scope.row.storeAddress),1)])]),_:1}),t(d,{fixed:"right",label:"二维码",width:"150",align:"center"},{default:s(()=>[V("template",ce,[t(a,{onClick:o[0]||(o[0]=S=>e.setCode(e.scope.row)),type:"text",size:"small"},{default:s(()=>[...o[5]||(o[5]=[$("生成二维码",-1)])]),_:1})])]),_:1}),t(d,{fixed:"right",label:"操作",width:"120",align:"center"},{default:s(()=>[V("template",fe,[t(a,{onClick:o[1]||(o[1]=S=>e.updateClick(e.scope.row)),type:"text",size:"small"},{default:s(()=>[...o[6]||(o[6]=[$("编辑",-1)])]),_:1}),t(a,{onClick:o[2]||(o[2]=S=>e.deleteClick(e.scope.row)),type:"text",size:"small"},{default:s(()=>[...o[7]||(o[7]=[$("删除",-1)])]),_:1})])]),_:1})]),_:1},8,["data"]),t(u,{dialogVisible:e.dialogVisible,onRefreshList:e.getList},null,8,["dialogVisible","onRefreshList"]),t(i,{dialogVisible:e.dialogVisible1,onRefreshList:e.getList,code:e.codes},null,8,["dialogVisible","onRefreshList","code"]),t(p,{dialogVisible:e.dialogVisible2,onRefreshList:e.getList,storeIds:e.storeId},null,8,["dialogVisible","onRefreshList","storeIds"]),t(v,{dialogVisible:e.dialogVisible3,onRefreshList:e.getList,onGetAppId:e.getAppIds},null,8,["dialogVisible","onRefreshList","onGetAppId"]),R(t(w,{total:e.total,page:e.pageNo,limit:e.pageSize,onPagination:e.getList},null,8,["total","page","limit","onPagination"]),[[W,e.total>0]])])}const Ce=N(re,[["render",ge]]);export{Ce as default};
